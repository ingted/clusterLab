
.TH FENCE_AGENT 8 2009-10-20 "fence_vmware (Fence Agent)"
.SH NAME
fence_vmware - Fence agent for VMWare
.SH DESCRIPTION
.P
fence_vmware is an I/O Fencing agent which can be used with the VMware ESX, VMware ESXi or VMware Server to fence virtual machines.
.P
Before you can use this agent, it must be installed VI Perl Toolkit or vmrun command on every node you want to make fencing.
.P
VI Perl Toolkit is preferred for VMware ESX/ESXi and Virtual Center. Vmrun command is only solution for VMware Server 1/2 (this command will works against ESX/ESXi 3.5 up2 and VC up2 too, but not cluster aware!) and is available as part of VMware VIX API SDK package. VI Perl and VIX API SDK are both available from VMware web pages (not int RHEL repository!). 
.P
You can specify type of VMware you are connecting to with \fB-d\fP switch (or \fIvmware_type\fR for stdin). Possible values are esx, server2 and server1.Default value is esx, which will use VI Perl. With server1 and server2, vmrun command is used.
.P
After you have successfully installed VI Perl Toolkit or VIX API, you should be able to run fence_vmware_helper (part of this agent) or vmrun command. This agent supports only vmrun from version 2.0.0 (VIX API 1.6.0).
.P
fence_vmware accepts options on the command line as well
as from stdin. Fenced sends parameters through stdin when it execs the
agent. fence_vmware can be run by itself with command
line options.  This is useful for testing and for turning outlets on or off
from scripts.

Vendor URL: http://www.vmware.com
.SH PARAMETERS

	
.TP
.B -o, --action=[action]
. 
Fencing action (Default Value: reboot)
	
.TP
.B -e, --exec=[command]
. 
Command to execute
	
.TP
.B -k, --identity-file=[filename]
. 
Identity file (private key) for SSH
	
.TP
.B -4, --inet4-only
. 
Forces agent to use IPv4 addresses only
	
.TP
.B -6, --inet6-only
. 
Forces agent to use IPv6 addresses only
	
.TP
.B -a, --ip=[ip]
. 
IP address or hostname of fencing device
	
.TP
.B -u, --ipport=[port]
. 
TCP/UDP port to use for connection with device (Default Value: 22)
	
.TP
.B -l, --username=[name]
. 
Login name This parameter is always required.
	
.TP
.B -p, --password=[password]
. 
Login password or passphrase
	
.TP
.B -S, --password-script=[script]
. 
Script to run to retrieve password
	
.TP
.B -n, --plug=[ip]
. 
IP address or hostname of fencing device (together with --port-as-ip)
	
.TP
.B -x, --ssh
. 
Use SSH connection (Default Value: 1)
	
.TP
.B --ssh-options=[options]
. 
SSH options to use
	
.TP
.B -d, --vmware_type=[type]
. 
Type of VMware to connect (Default Value: esx)
	
.TP
.B -s, --vmware-datacenter=[dc]
. 
VMWare datacenter filter
	
.TP
.B -v, --verbose
. 
Verbose mode
	
.TP
.B -D, --debug-file=[debugfile]
. 
Write debug information to given file
	
.TP
.B -V, --version
. 
Display version information and exit
	
.TP
.B -h, --help
. 
Display help and exit
	
.TP
.B --delay=[seconds]
. 
Wait X seconds before fencing is started (Default Value: 0)
	
.TP
.B --login-timeout=[seconds]
. 
Wait X seconds for cmd prompt after login (Default Value: 5)
	
.TP
.B --port-as-ip
. 
Make "port/plug" to be an alias to IP address
	
.TP
.B --power-timeout=[seconds]
. 
Test X seconds for status change after ON/OFF (Default Value: 20)
	
.TP
.B --power-wait=[seconds]
. 
Wait X seconds after issuing ON/OFF (Default Value: 0)
	
.TP
.B --shell-timeout=[seconds]
. 
Wait X seconds for cmd prompt after issuing command (Default Value: 3)
	
.TP
.B --retry-on=[attempts]
. 
Count of attempts to retry power on (Default Value: 1)
	
.TP
.B --ssh-path=[path]
. 
Path to ssh binary (Default Value: /usr/bin/ssh)

.SH ACTIONS

	
.TP
\fBon \fP
Power on machine.
	
.TP
\fBoff \fP
Power off machine.
	
.TP
\fBreboot \fP
Reboot machine.
	
.TP
\fBstatus \fP
This returns the status of the plug/virtual machine.
	
.TP
\fBmonitor \fP
Check the health of fence device
	
.TP
\fBmetadata \fP
Display the XML metadata describing this resource.
	
.TP
\fBvalidate-all \fP
Validate if all required parameters are entered.

.SH STDIN PARAMETERS

	
.TP
.B action
. 
Fencing action (Default Value: reboot)
	
.TP
.B exec
. 
Command to execute
	
.TP
.B identity_file
. 
Identity file (private key) for SSH
	
.TP
.B inet4_only
. 
Forces agent to use IPv4 addresses only
	
.TP
.B inet6_only
. 
Forces agent to use IPv6 addresses only
	
.TP
.B ipaddr
. 
IP address or hostname of fencing device
	
.TP
.B ipport
. 
TCP/UDP port to use for connection with device (Default Value: 22)
	
.TP
.B login
. 
Login name This parameter is always required.
	
.TP
.B passwd
. 
Login password or passphrase
	
.TP
.B passwd_script
. 
Script to run to retrieve password
	
.TP
.B port
. 
IP address or hostname of fencing device (together with --port-as-ip)
	
.TP
.B secure
. 
Use SSH connection (Default Value: 1)
	
.TP
.B ssh_options
. 
SSH options to use
	
.TP
.B vmware_type
. 
Type of VMware to connect (Default Value: esx)
	
.TP
.B vmware_datacenter
. 
VMWare datacenter filter
	
.TP
.B verbose
. 
Verbose mode
	
.TP
.B debug
. 
Write debug information to given file
	
.TP
.B version
. 
Display version information and exit
	
.TP
.B help
. 
Display help and exit
	
.TP
.B delay
. 
Wait X seconds before fencing is started (Default Value: 0)
	
.TP
.B login_timeout
. 
Wait X seconds for cmd prompt after login (Default Value: 5)
	
.TP
.B port_as_ip
. 
Make "port/plug" to be an alias to IP address
	
.TP
.B power_timeout
. 
Test X seconds for status change after ON/OFF (Default Value: 20)
	
.TP
.B power_wait
. 
Wait X seconds after issuing ON/OFF (Default Value: 0)
	
.TP
.B shell_timeout
. 
Wait X seconds for cmd prompt after issuing command (Default Value: 3)
	
.TP
.B retry_on
. 
Count of attempts to retry power on (Default Value: 1)
	
.TP
.B ssh_path
. 
Path to ssh binary (Default Value: /usr/bin/ssh)
